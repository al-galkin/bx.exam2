# [ex2-70] Разработать простой компонент «Каталог товаров»

*Подробное описание задачи смотреть в материалах: [примеры заданий (pdf)](../pubinfo/Ex2AllType.pdf)*

## Общие требования 

* У созданного компонента задать код: simplecomp.exam, название: «Мой компонент», раздел для отображения компонента в визуальном редакторе: «Экзамен №2».

* Работу решения продемонстрировать в разделе сайта /ex2/simplecomp/, добавить пункт в главное меню «Экзамен2», и пункт в левом меню «Простой компонент».

## Решаемая задача

* Компонент должен выводить список товаров, сгруппированных по альтернативному классификатору. Альтернативный классификатор – новости.

* Будет использоваться множественная привязка разделов каталога товаров к альтернативному классификатору – новостям. Привязка элементов к разделам в инфоблоке Продукция остается по умолчанию, задавать множественную - не нужно.

* Используется только один уровень разделов, вложенности – не будет.

* Большой объем разделов и элементов не предполагается (не более 20 разделов и 100 элементов), лимиты на выборку и постраничная навигация – не нужны.

## Решение

* Для ускорения процесса можно скопировать любой системный компонент Битрикс, в результате вы получите всю необходимую структуру компонента, которую потом сможете отредактировать в соответствии с условиями задания.

1) Подготавливаем "заготовку" для компонента:

    1.1) Берём за основу системный компонент \bitrix\components\bitrix\photo.random\, копируем его в \local\components\simplecomp\

    1.2) Удаляем лишние файлы и папки из компонента:
        * local/components/simplecomp/ex2-70/images
        * local/components/simplecomp/ex2-70/lang/en
        * component.php - вместо него, мы будем использовать файл class.php (можно взять из bitrix/components/bitrix/app.placement/class.php)
        * и т.д.

    1.3) Правим описание компонента .description.php
        * Изменяем параметры:
            * Удаляем иконку, в новых версиях компонентов они не используются - "ICON" => "/images/photo_view.gif"
            * Правим раздел для отображения компонента в визуальном редакторе: "ID" и "NAME"
        * /lang/ru/.description.php
    
    1.4) Правим параметры компонента - .parameters.php
        * Удаляем лишнее, оставляем только $arComponentParameters
        * Правим параметры:
            * BASE - Базовые параметры для работы компонента
        * /lang/ru/.parameters.php

    1.5) class.php
        * Для ускорения берём готовый файл, чтобы меньше писать, например, из /bitrix/components/bitrix/app.placement/class.php, который в себе уже содержит все основные методы и структуру.
        * public function onPrepareComponentParams($arParams)
        * public function executeComponent()

2) Настройка ИБ:
    * Добавляем новое пользовательское св-во "UF_NEWS_LINK" в ИБ "Продукция"
    * Задаем разделам в ИБ "Продукция" привязку к нескольким новостям

3) Создаем раздел (каталог + название). Добавляем компонент на страницу. Вводим параметры.

4) Реализация логики компонента - подготавливаем arResult:
    4.1) Выборка разделов из ИБ "Продукция" - CIBlockSection::GetList 
    4.2) Выборка товаров из ИБ "Продукция" по выбранным разделам - CIBlockElement::GetList
    4.3) Выборка элементов из ИБ "Новости"
    4.4) Реализуем кеширование
    4.5) Устанавливаем заголовок страницы

5) Формируем вывод в шаблоне компонента


## Полезные ссылки

* [Вебинар: Готовимся в экзамену №2, отложенные функции и кеширование в компонентах](https://www.youtube.com/watch?v=KC6WcgaEWt4&feature=youtu.be)
* [Разработчик Bitrix Framework: Описание компонента](https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&LESSON_ID=2828)
* [Разработчик Bitrix Framework: Параметры компонента](https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&LESSON_ID=2132)
* [Документация для разработчиков: setResultCacheKeys](https://dev.1c-bitrix.ru/api_help/main/reference/cbitrixcomponent/setresultcachekeys.php)

* https://ro-man.su/blog/video_lessons/bitrix-exam-2/lesson-7/ (страница и видео на YouTube были удалены автором)
* https://ro-man.su/upload/iblock/bcf/bcfa41e9e7a71ea8a6b97f66df6e4b03.zip (удалено совсем)

____
* [Задания](tasks.md)
* [README.md](../../README.md)